<!DOCTYPE html><html lang="ko"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1"><title>설문(15명) 집계·분석 LITE</title><style>body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans KR",sans-serif;background:#0b1020;color:#e6eefc}h1{font-size:18px;margin:12px 0}small{color:#9fb2d6} .wrap{max-width:980px;margin:0 auto;padding:12px} .tabs{display:flex;gap:6px;margin:8px 0} .tab{padding:6px 10px;border:1px solid #24304d;border-radius:8px;background:#121a2f;color:#9fb2d6;cursor:pointer;font-weight:700;font-size:12px} .tab.active{color:#e6eefc;border-color:#34519a} .kpis{display:grid;grid-template-columns:repeat(3,1fr);gap:8px} .card{background:#121a2f;border:1px solid #24304d;border-radius:10px;padding:10px;margin-top:8px} .pill{display:inline-block;border:1px solid #24304d;border-radius:999px;padding:2px 8px;font-size:12px} input[type=number]{width:72px;background:#0f1730;border:1px solid #24304d;border-radius:6px;color:#e6eefc;padding:4px;text-align:right} .grid{display:grid;gap:8px} .agggrid{display:grid;grid-template-columns:1fr repeat(6,72px);gap:6px;align-items:center} .hdr{color:#9fb2d6;font-size:12px} .barchart{display:flex;gap:6px;align-items:flex-end;height:100px} .bar{flex:1;background:linear-gradient(180deg,#4f8cff,#1d4ed8);border-radius:4px 4px 0 0;min-height:6px;text-align:center;font-size:10px;padding:2px} table{width:100%;border-collapse:collapse;font-size:12px} th,td{border:1px solid #24304d;padding:6px 8px;text-align:right} th:first-child,td:first-child{text-align:left} .warn{color:#ef4444;font-weight:700} @media(max-width:860px){.kpis{grid-template-columns:1fr}.agggrid{grid-template-columns:1fr repeat(3,72px)}}
</style></head><body><div class="wrap"><header><h1>설문(15명) 집계·분석 <span class="pill" id="resp">n=0</span></h1><small>종이 설문에서 보기별 인원수만 입력 → 저장 → 분석/리포트 자동 생성</small><div class="kpis"><div class="card"><div>종합 점수</div><div id="kpi-over" style="font-size:22px;font-weight:800">0.0</div></div><div class="card"><div>NPS</div><div id="kpi-nps" style="font-size:22px;font-weight:800">0.0</div><small id="kpi-nps-sub">P0/D0</small></div><div class="card"><div>Top2 평균</div><div id="kpi-top2" style="font-size:22px;font-weight:800">0.0%</div></div></div><div class="tabs"><div class="tab active" data-t="aggregate">집계입력</div><div class="tab" data-t="analysis">분석</div><div class="tab" data-t="report">리포트</div></div></header>
<main id="tab-aggregate"><section class="card"><b>리커트(1~5점 인원수)</b><div class="agggrid" id="agg-likert"><div></div><div class="hdr">1점</div><div class="hdr">2점</div><div class="hdr">3점</div><div class="hdr">4점</div><div class="hdr">5점</div><div class="hdr">합계</div></div><small class="warn" id="warn-lik" style="display:none">⚠ 문항별 합계 15명 권장</small></section><section class="card"><b>NPS(0~10 인원수)</b><div class="agggrid" id="agg-nps"></div><small class="warn" id="warn-nps" style="display:none">⚠ 총합 15명 권장</small></section><section class="card"><b>카테고리(옵션 인원수)</b><div id="agg-cats" class="grid"></div><small class="warn" id="warn-cats" style="display:none">⚠ 단일선택 총합 15명 권장</small></section><div class="card"><button id="btn-apply">집계값 저장</button> <button id="btn-export">내보내기(JSON)</button> <label class="pill" style="cursor:pointer">가져오기<input id="in-import" type="file" accept="application/json" style="display:none"></label></div></main>
<main id="tab-analysis" style="display:none"><section class="card"><b>문항별 점수(0~100)</b><div id="likert-chart" class="barchart"></div></section><section class="card"><b>리커트 상세</b><table><thead><tr><th>문항</th><th>n</th><th>평균</th><th>0~100</th><th>Top2%</th><th>Bottom2%</th></tr></thead><tbody id="likert-stats"></tbody></table></section><section class="card"><b>NPS 상세</b><div id="nps-stats" class="hdr"></div></section><section class="grid" id="cat-ins" style="gap:8px"></section><section class="card" id="price-ins"></section></main>
<main id="tab-report" style="display:none"><section class="card"><b>자동 해석문</b><textarea id="tx-interpret" readonly style="width:100%;min-height:120px;background:#0f1730;border:1px solid #24304d;color:#e6eefc;border-radius:8px;padding:8px"></textarea><div style="margin-top:6px"><button id="btn-copy1">복사</button></div></section><section class="card"><b>최종 결론</b><textarea id="tx-conclusion" readonly style="width:100%;min-height:100px;background:#0f1730;border:1px solid #24304d;color:#e6eefc;border-radius:8px;padding:8px"></textarea><div style="margin-top:6px"><button id="btn-copy2">복사</button></div></section></main>
<footer><small>데이터는 브라우저에 자동 저장됩니다.</small></footer></div>
<script>const LIKERTS=[{key:'Q2',label:'Q2 호감도'},{key:'Q3',label:'Q3 신뢰감'},{key:'Q4',label:'Q4 크기 적합'},{key:'Q5',label:'Q5 그립감'},{key:'Q7',label:'Q7 표시 직관성'},{key:'Q9',label:'Q9 진행표시 도움'},{key:'Q10',label:'Q10 투입구 명확성'},{key:'Q12',label:'Q12 위생/세척 용이성'},{key:'Q14',label:'Q14 색 조합 선호'}];const CATS=[{key:'Q1',label:'Q1 첫인상(복수)',options:['깔끔','의료기기','가전같음','장난감','고급','차가움','따뜻','미니멀','둔탁','기타'],multi:true},{key:'Q6',label:'Q6 링 느낌',options:['매우 좋음','눈에 잘 들어옴','없어도 됨','지저분','모름','기타'],multi:false},{key:'Q8',label:'Q8 가독 환경(복수)',options:['밝은 욕실','어두운 화장실','침실 아침','자연광','모름','기타'],multi:true},{key:'Q11',label:'Q11 SD 슬롯 인상',options:['전문적','구식/불편','무관','모름'],multi:false},{key:'Q13',label:'Q13 장소',options:['욕실','침실','화장대','거실','휴대','기타'],multi:false},{key:'Q15',label:'Q15 포인트 컬러(복수)',options:['실버','샴페인','미스트 블루','로즈','블랙','기타'],multi:true},{key:'Q16',label:'Q16 가격',options:['≤₩5만','₩5~9.9만','₩10~19.9만','≥₩20만'],multi:false}];let likert={},nps=Array(11).fill(0),cats={};LIKERTS.forEach(q=>likert[q.key]=[0,0,0,0,0]);CATS.forEach(q=>cats[q.key]=Array(q.options.length).fill(0));const sum=a=>a.reduce((x,y)=>x+y,0),clamp01=x=>Math.max(0,Math.min(1,x)),pct=x=>((x*100).toFixed(1)+'%');const save=()=>localStorage.setItem('mini15_lite',JSON.stringify({likert,nps,cats}));const load=()=>{try{const d=JSON.parse(localStorage.getItem('mini15_lite'));if(d){likert=d.likert||likert;nps=d.nps||nps;cats=d.cats||cats}}catch(e){}};function switchTab(name){['aggregate','analysis','report'].forEach(n=>document.getElementById('tab-'+n).style.display=(n===name?'block':'none'))}document.querySelectorAll('.tab').forEach(t=>t.addEventListener('click',()=>{document.querySelectorAll('.tab').forEach(x=>x.classList.remove('active'));t.classList.add('active');switchTab(t.dataset.t);if(t.dataset.t==='aggregate') renderAgg()}));
function renderAgg(){const L=document.getElementById('agg-likert');L.querySelectorAll('.row').forEach(e=>e.remove());LIKERTS.forEach(q=>{const r=document.createElement('div');r.className='agggrid row';r.innerHTML='<div>'+q.label+'</div>'+[0,1,2,3,4].map(i=>`<input type="number" min="0" step="1" data-k="${q.key}" data-i="${i}" value="${likert[q.key][i]}">`).join('')+`<div class="hdr" id="sum-${q.key}">${sum(likert[q.key])}</div>`;L.appendChild(r)});const N=document.getElementById('agg-nps');N.innerHTML='<div class="hdr">점수</div>'+Array.from({length:11},(_,i)=>`<div class="hdr">${i}</div>`).join('')+'<div class="hdr">합계</div>';const nr=document.createElement('div');nr.className='agggrid';nr.innerHTML='<div>NPS</div>'+Array.from({length:11},(_,i)=>`<input type="number" min="0" step="1" data-nps="${i}" value="${nps[i]}">`).join('')+`<div class="hdr" id="sum-nps">${sum(nps)}</div>`;N.appendChild(nr);const C=document.getElementById('agg-cats');C.innerHTML='';CATS.forEach(q=>{const card=document.createElement('div');card.className='card';card.innerHTML=`<b>${q.label}</b> <small class="hdr">${q.multi?'복수':'단일(15권장)'}</small>`;q.options.forEach((opt,i)=>{const row=document.createElement('div');row.className='agggrid';row.innerHTML=`<div>${opt}</div><input type="number" min="0" step="1" data-cat="${q.key}" data-i="${i}" value="${cats[q.key][i]}"><div></div><div></div><div></div><div></div><div class="hdr" id="sum-${q.key}-${i}">${cats[q.key][i]}</div>`;card.appendChild(row)});C.appendChild(card)});hookAgg()}function hookAgg(){document.querySelectorAll('#agg-likert input').forEach(inp=>inp.addEventListener('input',()=>{const k=inp.dataset.k;document.getElementById('sum-'+k).textContent=[...document.querySelectorAll(`#agg-likert input[data-k="${k}"]`)].map(x=>+x.value||0).reduce((a,b)=>a+b,0);checkWarn()}));document.querySelectorAll('#agg-nps input').forEach(inp=>inp.addEventListener('input',()=>{document.getElementById('sum-nps').textContent=[...document.querySelectorAll('#agg-nps input')].map(x=>+x.value||0).reduce((a,b)=>a+b,0);checkWarn()}));document.querySelectorAll('#agg-cats input').forEach(inp=>inp.addEventListener('input',checkWarn))}function checkWarn(){let likOver=false;LIKERTS.forEach(q=>{const tot=[...document.querySelectorAll(`#agg-likert input[data-k="${q.key}"]`)].map(x=>+x.value||0).reduce((a,b)=>a+b,0);if(tot>15)likOver=true});document.getElementById('warn-lik').style.display=likOver?'inline':'none';const nTot=[...document.querySelectorAll('#agg-nps input')].map(x=>+x.value||0).reduce((a,b)=>a+b,0);document.getElementById('warn-nps').style.display=nTot>15?'inline':'none';let cOver=false;CATS.forEach(q=>{if(!q.multi){const tot=q.options.map((_,i)=>{const el=document.querySelector(`#agg-cats input[data-cat="${q.key}"][data-i="${i}"]`);return el?+el.value||0:0}).reduce((a,b)=>a+b,0);if(tot>15)cOver=true}});document.getElementById('warn-cats').style.display=cOver?'inline':'none'}
function applyAgg(){LIKERTS.forEach(q=>{for(let i=0;i<5;i++){const v=parseInt(document.querySelector(`#agg-likert input[data-k="${q.key}"][data-i="${i}"]`).value||'0');likert[q.key][i]=isNaN(v)?0:v}});for(let i=0;i<=10;i++){const v=parseInt(document.querySelector(`#agg-nps input[data-nps="${i}"]`).value||'0');nps[i]=isNaN(v)?0:v}CATS.forEach(q=>{for(let i=0;i<q.options.length;i++){const v=parseInt(document.querySelector(`#agg-cats input[data-cat="${q.key}"][data-i="${i}"]`).value||'0');cats[q.key][i]=isNaN(v)?0:v}});renderAll();alert('반영 완료')}document.getElementById('btn-apply').addEventListener('click',applyAgg);document.getElementById('btn-export').addEventListener('click',()=>{const blob=new Blob([JSON.stringify({likert,nps,cats},null,2)],{type:'application/json'});const a=document.createElement('a');a.href=URL.createObjectURL(blob);a.download='survey15_lite.json';a.click()});document.getElementById('in-import').addEventListener('change',e=>{const f=e.target.files[0];if(!f)return;const r=new FileReader();r.onload=()=>{try{const d=JSON.parse(r.result);if(d.likert&&d.nps&&d.cats){likert=d.likert;nps=d.nps;cats=d.cats;renderAll()}else alert('형식 오류')}catch{alert('읽기 오류')}};r.readAsText(f)})
function renderCore(){// KPI
const scores=LIKERTS.map(q=>{const a=likert[q.key],N=sum(a),m=N?a.map((c,i)=>c*(i+1)).reduce((x,y)=>x+y,0)/N:0;return clamp01((m-1)/4)*100});const overall=scores.filter(s=>!isNaN(s)).reduce((a,b)=>a+b,0)/(scores.length||1);document.getElementById('kpi-over').textContent=overall.toFixed(1);const top2=LIKERTS.map(q=>{const a=likert[q.key],N=sum(a);return N?(a[3]+a[4])/N:0});document.getElementById('kpi-top2').textContent=((top2.reduce((a,b)=>a+b,0)/(LIKERTS.length||1))*100).toFixed(1)+'%';const n=sum(nps);let detr=0,prom=0,npsS=0;if(n>0){detr=sum(nps.slice(0,7))/n;prom=sum(nps.slice(9))/n;npsS=(prom-detr)*100}document.getElementById('kpi-nps').textContent=npsS.toFixed(1);document.getElementById('kpi-nps-sub').textContent='P'+pct(prom)+' / D'+pct(detr);document.getElementById('resp').textContent='n='+(LIKERTS.reduce((acc,q)=>acc+sum(likert[q.key]),0)/LIKERTS.length|0)}
function renderCharts(){const lc=document.getElementById('likert-chart');lc.innerHTML='';LIKERTS.forEach(q=>{const a=likert[q.key],N=sum(a),m=N?a.map((c,i)=>c*(i+1)).reduce((x,y)=>x+y,0)/N:0,s=clamp01((m-1)/4)*100,h=Math.max(6,s/100*90);const d=document.createElement('div');d.className='bar';d.style.height=h+'px';d.title=q.key+': '+s.toFixed(1);d.textContent=s.toFixed(1);lc.appendChild(d)});const tbody=document.getElementById('likert-stats');tbody.innerHTML='';LIKERTS.forEach(q=>{const a=likert[q.key],n=sum(a),m=n?a.reduce((t,c,i)=>t+c*(i+1),0)/n:0,m100=clamp01((m-1)/4)*100,top2=n?((a[3]+a[4])/n*100).toFixed(1):'0.0',bot2=n?((a[0]+a[1])/n*100).toFixed(1):'0.0';const tr=document.createElement('tr');tr.innerHTML=`<td>${q.label}</td><td>${n}</td><td>${m.toFixed(2)}</td><td>${m100.toFixed(1)}</td><td>${top2}%</td><td>${bot2}%</td>`;tbody.appendChild(tr)});const n=sum(nps),d=n?sum(nps.slice(0,7))/n:0,p=n?sum(nps.slice(9))/n:0,S=(p-d)*100,se=n?Math.sqrt((p*(1-p)+d*(1-d))/n)*100:0;document.getElementById('nps-stats').textContent=`n=${n} · P ${Math.round(p*100)}% (${sum(nps.slice(9))}) / D ${Math.round(d*100)}% (${sum(nps.slice(0,7))}) · NPS ${S.toFixed(1)} (±${(1.96*se).toFixed(1)})`;const cat=document.getElementById('cat-ins');cat.innerHTML='';CATS.forEach(q=>{const a=cats[q.key],tot=a.reduce((x,y)=>x+y,0)||1,hhi=a.reduce((acc,c)=>acc+Math.pow(c/tot,2),0),band=hhi>0.35?'의견 집중':hhi>0.23?'부분 집중':'의견 분산';const top=a.map((v,i)=>[v,i]).sort((A,B)=>B[0]-A[0]).slice(0,3).map(([v,i])=>`${q.options[i]} ${v}명(${(v/tot*100).toFixed(1)}%)`).join(' · ');const div=document.createElement('div');div.className='card';div.innerHTML=`<b>${q.label}</b> <small class="pill">${band}</small><div class="hdr">합계 ${tot} · HHI ${hhi.toFixed(2)}</div><div style="margin-top:4px">TOP: ${top||'—'}</div>`;cat.appendChild(div)});const price=cats['Q16'];if(price){const lab=['≤₩5만','₩5~9.9만','₩10~19.9만','≥₩20만'];const tot=price.reduce((a,b)=>a+b,0)||1,mode=price.indexOf(Math.max(...price)),cum=price.map((v,i)=>price.slice(0,i+1).reduce((a,b)=>a+b,0)),mid=cum.findIndex(x=>x>=tot/2);const box=document.getElementById('price-ins');box.className='card';box.innerHTML=`<b>가격 인사이트</b><div>최빈: <b>${lab[mode]||'-'}</b> (${price[mode]||0}명)</div><small class="hdr">중앙값: ${lab[mid]||'-'} · 분포: ${price.map((v,i)=>lab[i]+" "+v+"명").join(' / ')}</small>`}}
function renderReport(){const scores=LIKERTS.map(q=>{const a=likert[q.key],N=sum(a),m=N?a.map((c,i)=>c*(i+1)).reduce((x,y)=>x+y,0)/N:0;return {key:q.key,score:clamp01((m-1)/4)*100}});const overall=(scores.reduce((a,b)=>a+b.score,0)/(scores.length||1))||0;const sorted=[...scores].sort((a,b)=>b.score-a.score),best=sorted[0]||{key:'-',score:0},worst=sorted[sorted.length-1]||{key:'-',score:0};const n=sum(nps);let d=0,p=0,S=0;if(n){d=sum(nps.slice(0,7))/n;p=sum(nps.slice(9))/n;S=(p-d)*100}const band=s=>s>=80?'매우 우수':s>=70?'우수':s>=60?'양호':s>=50?'보통':'개선 필요';const top=(k,n=3)=>{const a=cats[k],q=CATS.find(x=>x.key===k);return a.map((c,i)=>({label:q.options[i],c})).sort((x,y)=>y.c-x.c).slice(0,n)};const q1=top('Q1',3).map(x=>`${x.label}(${x.c})`).join(', '),q15=top('Q15',2).map(x=>x.label).join(', ');const ci=(()=>{const se=n?Math.sqrt((p*(1-p)+d*(1-d))/n)*100:0;return [(S-1.96*se).toFixed(1),(S+1.96*se).toFixed(1)]})();const interp=[`종합 점수: ${overall.toFixed(1)}점 (${band(overall)})`,`강점 문항: ${best.key} (${best.score.toFixed(1)}점)`,`보강 문항: ${worst.key} (${worst.score.toFixed(1)}점)`,`NPS: ${S.toFixed(1)} (95% CI ${ci[0]}~${ci[1]})`,`첫인상 TOP3: ${q1}`,`대체 컬러 TOP2: ${q15}`].join('\n');document.getElementById('tx-interpret').value=interp;let verdict='재설계 권장';if(overall>=75&&S>=30)verdict='출시 적합';else if(overall>=65&&S>=0)verdict='개선 후 출시 검토';const rec=[];if(overall<60)rec.push('전반적 사용성/감성 품질 개선이 필요합니다. 최약점 리커트 문항 중심으로 개선안을 도출하세요.');if(S<0)rec.push('부정 요인 파악을 위해 Detractor 인터뷰(3~5명)를 진행하세요.');['Q6','Q11','Q13','Q16'].forEach(k=>{const a=cats[k];const idx=a.indexOf(Math.max(...a));if(idx>=0){const opt=CATS.find(x=>x.key===k).options[idx];rec.push(`${k}: '${opt}' 선호가 큽니다. 해당 속성을 우선 검토하세요.`)}});document.getElementById('tx-conclusion').value=`결론: ${verdict}\n근거: 종합 ${overall.toFixed(1)} / NPS ${S.toFixed(1)} · 최약점 ${worst.key}\n권고: ${rec.slice(0,4).map((t,i)=>`${i+1}) ${t}`).join('\n')}`}function renderAll(){renderCore();renderCharts();renderReport();save()}document.getElementById('btn-copy1').onclick=()=>{const t=document.getElementById('tx-interpret');t.select();document.execCommand('copy');alert('복사됨')};document.getElementById('btn-copy2').onclick=()=>{const t=document.getElementById('tx-conclusion');t.select();document.execCommand('copy');alert('복사됨')};
load();renderAgg();renderAll();</script></body></html>
